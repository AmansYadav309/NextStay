<% layout('/layouts/boilerplate.ejs') -%>


<body>
    <div class="container">
    <div class="row row-6 offset-2" >
<h2>Edit listing</h2>
<form  method="post"   action="/listings/<%= listid._id %>?_method=PUT" class="needs-validation" novalidate  enctype="multipart/form-data">

    <div class="mb-3"> 
        <label for="title" class = "form-label">Title</label>
         <input type="text" name="list[title]"   value="<%= listid.title %>" class="form-control"  required>
          <div class="valid-feedback">
            Looks good!
        </div>
    </div>
   
    <div class="mb-3">
        <label for="description" class = "form-label">Description</label>
    <textarea name="list[description]" class="form-control "   required ><%= listid.description %>  </textarea>
        <div class="invalid-feedback">
            Please write peoper discription .
        </div>
    </div>

    <div class="mb-3">
  <label class="form-label fw-semibold">Original Images</label>
  
  <% if (listid.image && listid.image.length > 0) { %>
    <div class="d-flex flex-wrap gap-3 mt-2">
      <% listid.image.forEach(img => { %>
        <div class="card-edit shadow-sm" style="width: 180px; border: 2px solid #d0e7ff; border-radius: 10px;">
          <img src="<%= img.url.replace('/upload', '/upload/w_300,h_200,c_fill') %>"
               alt="Listing image"
               class="card-img-top"
               style="border-radius: 10px 10px 0 0; object-fit: cover; height: 150px;">
          <div class="card-body p-2 text-center">
            <p class="small text-muted mb-0"><%= img.filename || 'Image' %></p>
          </div>
        </div>
      <% }) %>
    </div>
  <% } else { %>
    <p class="text-muted">No images available for this listing.</p>
  <% } %>
</div>

    <div class="mb-3"   >
         <label for="image" class = "form-label">Image</label>
          <input type="file" name="list[image][url]"  class="form-control" >
    </div>
    <div class="row  ">
    <div class="mb-3 col-4" >
         <label for="price" class = "form-label">Price</label>
        <input type="number" name="list[price]"  value="<%= listid.price %>"  class="form-control" required  >
        <div class="invalid-feedback">
            Please provide a valid price  .
         </div>
    </div>
    
    <div class="mb-3 col-8"  >
        <label for="location" class = "form-label">Location</label>
         <input type="text" name="list[location]"  value="<%= listid.location %>" class="form-control"  required > 
         <div class="invalid-feedback">
            Please provide a  valid  Location.
         </div>
    </div>


   </div>
    <div class="mb-3" >
        <label for="country" class = "form-label">Country</label>
        <input type="text" name="list[country]" value="<%= listid.country %>"  class="form-control"   required >
        <div class="invalid-feedback">
            Please provide a  valid  counter name.
         </div>
    </div>
    
  
    <button class="btn btn-dark btn-add">Edit</button>
    <br><br>
    </form>
    </div>
    </div>

    <script src="/js/script.js"></script>
</body>
